<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Andr√© Smalheer - Portfolio</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="images/logo.png" />
  </head>
  <body>
    <!-- mobile -->
    <div id="mobile_container"></div>

    <!-- desktop -->
    <div id="desktop_container"></div>
  </body>
  <script>
    async function includeHTML(containerId, url) {
      try {
        const response = await fetch(url);
        if (!response.ok)
          throw new Error(`Cannot load ${url}: ${response.status}`);
        const html = await response.text();
        document
          .getElementById(containerId)
          .insertAdjacentHTML("beforeend", html);
      } catch (err) {
        console.error(err);
      }
    }

    async function loadCSSFiles(files) {
      files.forEach((file) => {
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = file;
        document.head.appendChild(link);
      });
    }

    const cssFiles = [
      "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&display=swap",
      "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",
      "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&display=swap",
    ];

    const files = [
      "./desktop/header.html",
      "./general/main_container.html",
      "./general/about_me.html",
      "./general/projects.html",
      "./general/contact.html",
      "./general/footer.html",
    ];

    const mobileFiles = ["./mobile/menu.html", "./mobile/header.html"];

    async function loadHTMLFiles(containerId, files) {
      for (const file of files) {
        await includeHTML(containerId, file);
      }
    }

    loadCSSFiles(cssFiles);

    loadHTMLFiles("desktop_container", files);

    loadHTMLFiles("mobile_container", mobileFiles);
  </script>

  <script>
    async function initInteractions() {
      const waitForHTML = () =>
        new Promise((resolve) => {
          const check = () => {
            if (
              document.querySelector(".hamburger") &&
              document.getElementById("mobile-menu")
            ) {
              resolve();
            } else {
              requestAnimationFrame(check);
            }
          };
          check();
        });

      await waitForHTML();

      const hamburger = document.querySelector(".hamburger");
      const mobileMenu = document.getElementById("mobile-menu");
      const mobileMenuLinks = mobileMenu.querySelectorAll("a");
      const body = document.body;

      hamburger.addEventListener("click", () => {
        hamburger.classList.toggle("active");
        mobileMenu.classList.toggle("show");
      });

      mobileMenuLinks.forEach((link) => {
        link.addEventListener("click", () => {
          hamburger.classList.remove("active");
          mobileMenu.classList.remove("show");
        });
      });

      body.addEventListener("click", (e) => {
        if (
          !mobileMenu.contains(e.target) &&
          !hamburger.contains(e.target) &&
          mobileMenu.classList.contains("show")
        ) {
          hamburger.classList.remove("active");
          mobileMenu.classList.remove("show");
        }
      });
    }

    // Run interaction script
    initInteractions();
  </script>
</html>
