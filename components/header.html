<script>
  import {
    includeHTML,
    loadCSSFiles,
    loadHTMLFiles,
  } from "../html-css-loader.js";

  async function initInteractions() {
    const waitForHTML = () =>
      new Promise((resolve) => {
        const check = () => {
          if (
            document.querySelector(".hamburger") &&
            document.getElementById("mobile-menu")
          ) {
            resolve();
          } else {
            requestAnimationFrame(check);
          }
        };
        check();
      });

    await waitForHTML();

    const hamburger = document.querySelector(".hamburger");
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileMenuLinks = mobileMenu.querySelectorAll("a");
    const body = document.body;

    hamburger.addEventListener("click", () => {
      hamburger.classList.toggle("active");
      mobileMenu.classList.toggle("show");
    });

    mobileMenuLinks.forEach((link) => {
      link.addEventListener("click", () => {
        hamburger.classList.remove("active");
        mobileMenu.classList.remove("show");
      });
    });

    body.addEventListener("click", (e) => {
      if (
        !mobileMenu.contains(e.target) &&
        !hamburger.contains(e.target) &&
        mobileMenu.classList.contains("show")
      ) {
        hamburger.classList.remove("active");
        mobileMenu.classList.remove("show");
      }
    });
  }

  // Run interaction script
  initInteractions();

  const cssFiles = [
    "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&display=swap",
    "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",
    "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&display=swap",
    "/styles/header.css",
  ];

  loadCSSFiles(cssFiles);

  const mobileFiles = ["../mobile/menu.html", "../mobile/header.html"];

  const files = ["../desktop/header.html"];

  loadHTMLFiles("desktop_container", files);

  loadHTMLFiles("mobile_container", mobileFiles);
</script>
